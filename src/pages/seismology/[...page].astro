---
  import { z } from 'astro/zod';
  import BaseHead from "../../components/BaseHead.astro";
  import Header from "../../components/Header.astro";
  import Footer from "../../components/Footer.astro";
  import PreviewPosts from "../../components/PreviewPosts.astro";
  import { SITE_TITLE } from "../../config/site.consts";
  import { MENU_LINKS, SUBMENU_LINKS, TITLE } from "../../config/header.consts";
  import { getCollection } from "astro:content";
  import PaginationPost from '../../components/PaginationPost.astro';

  const POSTS_PER_PAGE = 6;

  // 1) Obtener y ordenar todos los posts de "seismology"
  const allPosts = (await getCollection("seismology")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  );

  const totalPages = Math.ceil(allPosts.length / POSTS_PER_PAGE);

  // 2) Indicarle a Astro qué rutas generar
  export async function getStaticPaths() {
      const POSTS_PER_PAGE = 6;
      const allPosts = (await getCollection("seismology")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  );
      const totalPages = Math.ceil(allPosts.length / POSTS_PER_PAGE);
    return Array.from({ length: totalPages }, (_, i) => ({
        params: { page: String(i + 1) }
      }))

    
  }

  // 3) Validar y parsear el parámetro page
  const paramsSchema = z.object({
    page: z
      .string()
      .regex(/^[1-9]d*$/, 'Debe ser un número positivo')
      .transform(Number)
  });
  const { page } = paramsSchema.parse(Astro.params);

  // 4) Slice de los posts para esta página
  const start = (page - 1) * POSTS_PER_PAGE;
  const pagePosts = allPosts.slice(start, start + POSTS_PER_PAGE);
  ---
  <!doctype html>
  <html lang="en">
    <head>
      <BaseHead
        title={SITE_TITLE + " | seismology" + "Page" + " " + page} 
        description="Super nice description"
      />
    </head>
    <body>
      <Header title={TITLE} links={MENU_LINKS} submenu={SUBMENU_LINKS} />
      <main class="flex flex-col items-center justify-center min-h-screen bg-light-bg dark:bg-dark-bg">
        <PreviewPosts posts={pagePosts} title="seismology" />
         <PaginationPost
            schemaName="seismology"
            page={page}
            totalPages={totalPages} />
      </main>
      <Footer />
    </body>
  </html>
  